
{{- $.Scratch.Set "rangepages" (where .Site.Pages "Section" "audits") -}}
{{- if ($.Scratch.Get "rangepages") -}}

  {{- $.Scratch.Set "aggregates" (partialCached "render/aggregate-scores.html" (dict "pages" ($.Scratch.Get "rangepages"))) -}}

  <section class="section text-center">
    <div class="fg-wrapper">
      {{- partialCached "utils/css.html" (dict "context" . "filefolder" "object" "filename" "card") "card" -}}
      {{ if gt (len ($.Scratch.Get "aggregates").accessibility.all) 0 }}
      <h2 class="lh-0">Liste des indicateurs<br><small>Pour {{ (len ($.Scratch.Get "aggregates").accessibility.all) }} services</small></h2>
        <ul class="list-unstyled" role="navigation">
            <li class="enlarge-link card-inline card-shadow">
              <h2 class="h3">Accessibilité <small>Conformité</small></h2>
              <span class="flex flex-gap align-items-center text-center lh-1 mr-2">
                {{- if gt ($.Scratch.Get "aggregates").accessibility.sum 0 -}}
                <b class="font-bold d-block m-auto w-max-content">
                  {{ len ($.Scratch.Get "aggregates").accessibility.invalid }}<br>
                  <small class="smaller">Non</small>
                </b>
                <b class="font-bold d-block m-auto w-max-content">
                  {{ sub (sub (len ($.Scratch.Get "aggregates").accessibility.all) (len ($.Scratch.Get "aggregates").accessibility.valid)) (len ($.Scratch.Get "aggregates").accessibility.invalid) }}<br>
                  <small class="smaller">Partielle</small>
                </b>
                <b class="font-bold d-block m-auto w-max-content">
                  {{ len ($.Scratch.Get "aggregates").accessibility.valid }}<br>
                  <small class="smaller">Oui</small>
                </b>
                {{- if gt ($.Scratch.Get "aggregates").accessibility.average 0 -}}
                  <b class="font-bold d-block m-auto w-max-content">
                    {{ ($.Scratch.Get "aggregates").accessibility.average }}%
                    <small class="smaller">Moyenne</small>
                  </b>
                {{- end -}}
                {{- else -}}
                  Aucun Audit RGAA existant
                {{- end -}}
              </span>
            </li>
            <li class="enlarge-link card-inline card-shadow">
              <h2 class="h3">Éco-conception <small>Conformité</small></h2>
              <span class="flex flex-gap align-items-center text-center lh-1 mr-2">
              {{- if gt ($.Scratch.Get "aggregates").ecoconception.sum 0 -}}
                <b class="font-bold d-block m-auto w-max-content">
                  {{ len ($.Scratch.Get "aggregates").ecoconception.invalid }}<br>
                  <small class="smaller">Non</small>
                </b>
                <b class="font-bold d-block m-auto w-max-content">
                  {{ sub (sub (len ($.Scratch.Get "aggregates").ecoconception.all) (len ($.Scratch.Get "aggregates").ecoconception.valid)) (len ($.Scratch.Get "aggregates").ecoconception.invalid) }}<br>
                  <small class="smaller">Partielle</small>
                </b>
                <b class="font-bold d-block m-auto w-max-content">
                  {{ len ($.Scratch.Get "aggregates").ecoconception.valid }}<br>
                  <small class="smaller">Oui</small>
                </b>
                {{- if gt ($.Scratch.Get "aggregates").ecoconception.average 0 -}}
                  <b class="font-bold d-block m-auto w-max-content">
                    {{ ($.Scratch.Get "aggregates").ecoconception.average }}%
                    <small class="smaller">Moyenne</small>
                  </b>
                {{- end -}}
                {{- else -}}
                  Aucun Audit RGESN existant
                {{- end -}}
              </span>
            </li>
            <li class="enlarge-link card-inline card-shadow">
              <h2 class="h3">Sobriété éditoriale <small>Conformité</small></h2>
              <span class="flex flex-gap align-items-center text-center lh-1 mr-2">
              {{- if gt ($.Scratch.Get "aggregates").publishing.sum 0 -}}
                <b class="font-bold d-block m-auto w-max-content">
                  {{ len ($.Scratch.Get "aggregates").publishing.invalid }}<br>
                  <small class="smaller">Non</small>
                </b>
                <b class="font-bold d-block m-auto w-max-content">
                  {{ sub (sub (len ($.Scratch.Get "aggregates").publishing.all) (len ($.Scratch.Get "aggregates").publishing.valid)) (len ($.Scratch.Get "aggregates").publishing.invalid) }}<br>
                  <small class="smaller">Partielle</small>
                </b>
                <b class="font-bold d-block m-auto w-max-content">
                  {{ len ($.Scratch.Get "aggregates").publishing.valid }}<br>
                  <small class="smaller">Oui</small>
                </b>
                {{- if gt ($.Scratch.Get "aggregates").publishing.average 0 -}}
                  <b class="font-bold d-block m-auto w-max-content">
                    {{ ($.Scratch.Get "aggregates").publishing.average }}%
                    <small class="smaller">Moyenne</small>
                  </b>
                {{- end -}}
                {{- else -}}
                  Aucun Audit Édito existant
                {{- end -}}
              </span>
            </li>
            <li class="enlarge-link card-inline card-shadow">
              {{- partialCached "components/scores/greenit-small" (dict "context" . "project" "") "" -}}
            </li>
            <li class="enlarge-link card-inline card-shadow">
              {{- partialCached "components/scores/cigref-small" (dict "context" . "project" "") "" -}}
            </li>
        </ul>
    </div>
  </section>
  {{- end -}}
{{- end -}}
